# LaTeX中的宏定义
一个TeX宏（macro）是以反斜杠开头的，后面紧跟着一串字母的字符串，在TeX中通常用来代表另外一个字符串，有时也表示一些其他的含义。传统上将这种字符串代替的机制称为宏，TeX就是一种复杂的宏语言。

**命令**和**环境**是LaTeX使用格式中相对固定的两类宏

## 自定义命令
newcommand的语法规则如下：
```latex
\newcommand\mingling[参数的个数][首参数的默认值]{具体定义}
%不要在命令里面放数字！
```
使用`\ensuremath`命令可以保证参数在数学模式下，即使原本就在数学模式下也不会报错。

### 最简单的newcommand命令
就是不带有任何的参数，只是使用宏定义里面的字符串替代的功能，不需要使用任何的参数。
```latex
\newcommand\PRC{People's Republic of \emph{China}}
```
注意：即使定义的内容只有一个字符，也一定要有花括号。

### newcommand一般的使用情况
如果指定了参数的个数（从一到九）则可以在宏定义中使用参数。在具体定义中使用，宏的参数依次编号，用#1、#2、……、#9表示，使用宏时它们就会替换成参数的字符串。
```latex
\newcommand\loves[2]{#1喜欢#2}
\loves{香草}{巧克力}
%香草喜欢巧克力
```

如果在使用中还指定了首个参数的默认值，那么这个命令的第一个参数就称为可选的参数（要使用中括号指定）
```latex
\newcommand\loves[3][喜欢]{#2#1#3}
\loves{香草}{巧克力}%香草喜欢巧克力
\loves[最喜欢]{香草}{巧克力}%香草最喜欢巧克力
```
首个默认值可以被后面使用时的可选参数替代，如果没有使用可选参数，就使用默认的值。

## renewcommand重定义
```latex
\renewcommand\mingling[参数个数][首参数默认值]{具体定义}
```
它的意义和用法和newcommand完全一样，只是newcommand只能用于定义新的定义，renewcommand只能用于修改已有的定义。如果不遵守会报错的（威胁）

可以嵌套使用定义，比如定义一个新定义用来修改定义（感觉用不到）则里面一层已经有的#1等要变成##1这样子（多加一个#）


# providecommand
```latex
\providecommand[参数的个数][首参数的默认值]{具体定义}
```
存在同名用别人的命令，不存在用自己的，为了不报错。

# 嵌套命令
最外层使用#1#2#3，第二层使用##1##2##3
```latex
\newcommand\lvec{}
\newcommand\DEFlvec[2]{\renewcommand\lvec[1]{\ensuremath{#1_1+\cdots+#1_##1}}}
\DEFlvec{x}{n}
$\lvec\neq\lvec[k]$
```

## 数学命令
```latex
\newcommand\CC{\ensuremath{\Gamma_{i}}}
%该命令可以使用如下两种形式：$\CC$和\CC，都是不会报错的，显示的都是数学环境下的形式
```
## 环境
```latex
\newenvironment{环境名}[参数个数][首参数默认值]{环境前定义}{环境后定义}
\renewenvironment{环境名}[参数个数][首参数默认值]{环境前定义}{环境后定义}
```
需要注意的是，只有环境前定义里可以使用环境参数，环境后定义则不能使用环境参数，如果有需要的话，可以在环境前定义里定义一个新的命令，在这个命令里面使用环境参数，然后在环境后定义里使用该命令，就等价于环境参数在环境后定义里的使用。
例子：
```latex
\newenvironment{Quotation}[1]
{\newcommand\quotesourse{#1}%
\begin{quotation}}%
{\par\hfill---\textit{\quotesourse}
\end{quotation}}
%quotation环境在每段前都有缩进，所以适合多端文字的引用。
%这里利用了这一特性，不过环境里面套环境啊。。
```
![[Pasted image 20231203175533.png]]

```latex
前后环境有什么区别？
1.一般的公式环境有两个部分，所以我们常常把一个begin放在前，另一个end放在后
2.定义环境时，千万不要中间有空行，否则会出错
3.中间不能有任何的东西，只能为空
4.创建的环境内不能有数学公式
```

## def 宏命令
```latex
% \def 定义宏命令
\def \sentence{this is a sentence}
\def \change(#1, #2){#2 #1}
\change(左, 右)
```

所以你此时一定很好奇，为什么还有def这命令，newcommand似乎已经够用了。
```latex
TEX \def\foo#1#2{#1 of #2}  
LATEX 2ε \newcommand\foo[2]{#1 of #2}  
LATEX3 \NewDocumentCommand\foo{mm}{#1 of #2}
```

原因在于这是版本的眼泪，TEX引擎运行底层命令时的苦与累不再为人所知。